#include<stdio.h>
#include<stdlib.h>
#include<omp.h>

int main(int argc, char **argv){

    //if(argc!=2){
    //    printf("One Of Data Missed");
    //    return 0;
    //}
    int A[19][19]={
       //0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//0
        {0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//1
        {0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//2
        {0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//3
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//4
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//5
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//6
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//7
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//8
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//9
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//10
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//11
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//12
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//13
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//14
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//15
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//16
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//17
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}//18
     };

     int A_new[19][19]={
        //0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//0
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//1
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//2
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//3
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//4
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//5
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//6
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//7
        {0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0},//8
        {0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0},//9
        {0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0},//10
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//11
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//12
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//13
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//14
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//15
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//16
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//17
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}//18
     };

    int sum=0;
    #pragma omp parallel shared(A,A_new) private(sum)
    {
        int iteration=0;
        while(iteration<100)
        {
                #pragma omp single
                {
                    int i,j;
                    for(i=1;i<18;++i)
                            for(j=1;j<18;++j)
                                A[i][j]=A_new[i][j];
                }
                #pragma omp barrier
                #pragma omp sections
                {
                    #pragma omp section
                    {
                        int i,j;
                        for(i=1;i<18;++i)
                            for(j=1;j<18;++j){
                                sum=A[i-1][j-1]+A[i-1][j]+A[i-1][j+1]+A[i][j-1]+A[i][j+1]+A[i+1][j-1]+A[i+1][j]+A[i+1][j+1];
                                if(A[i][j]==1&&(sum==2||sum==3))
                                    A_new[i][j]=1;
                                else if(A[i][j]==0&&sum==3)
                                    A_new[i][j]=1;
                                else
                                    A_new[i][j]=0;   
                            }
                            //printf("1->%u\n",omp_get_thread_num());
                    }
                    #pragma omp section
                    {
                        int i,j;
                        for(i=1;i<18;++i){
                            for(j=1;j<18;++j)
                            printf("%c",A[i][j]==1? '*':'-');
                        printf("\n");
                        }
                        printf("\n");
                        //printf("2->%u\n",omp_get_thread_num());
                    }
                }
                
                #pragma omp single
                {
                    getchar();     
                    printf("\e[1;1H\e[2J"); 
                }
            iteration+=1;
        }
    }
}
